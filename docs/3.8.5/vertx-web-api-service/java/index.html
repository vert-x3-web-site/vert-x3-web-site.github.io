<!DOCTYPE html>
<html lang="en">
<head>
  <title>Vert.x Web API Service - Vert.x</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta content="Eclipse Vert.x is a tool-kit for building reactive applications on the JVM." name="description">
  <link href="https://vertx.io/stylesheets/docs.css" media="screen" rel="stylesheet">
  <link href="https://vertx.io/stylesheets/font-awesome.min.css" media="screen" rel="stylesheet">
  <link href="https://vertx.io/javascripts/styles/rainbow.min.css" media="screen" rel="stylesheet">
  <!-- IE 6-8 support of HTML 5 elements -->
  <!--[if lt IE 9]>
  <script src="http://static.jboss.org/theme/js/libs/html5/pre3.6/html5.min.js"></script>
  <![endif]-->

  <link rel="apple-touch-icon" sizes="57x57" href="https://vertx.io/assets/favicons/vertx-favicon-7/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="https://vertx.io/assets/favicons/vertx-favicon-7/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="https://vertx.io/assets/favicons/vertx-favicon-7/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="https://vertx.io/assets/favicons/vertx-favicon-7/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="https://vertx.io/assets/favicons/vertx-favicon-7/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="https://vertx.io/assets/favicons/vertx-favicon-7/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="https://vertx.io/assets/favicons/vertx-favicon-7/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="https://vertx.io/assets/favicons/vertx-favicon-7/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://vertx.io/assets/favicons/vertx-favicon-7/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="https://vertx.io/assets/favicons/vertx-favicon-7/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="https://vertx.io/assets/favicons/vertx-favicon-7/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="https://vertx.io/assets/favicons/vertx-favicon-7/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="https://vertx.io/assets/favicons/vertx-favicon-7/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="https://vertx.io/assets/favicons/vertx-favicon-7/manifest.json">
  <link rel="mask-icon" href="https://vertx.io/assets/favicons/vertx-favicon-7/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#7d3194">
  <meta name="msapplication-TileImage" content="https://vertx.io/assets/favicons/vertx-favicon-7/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link href="https://fonts.googleapis.com/css?family=Ubuntu:400,500,700,400italic" rel="stylesheet" type="text/css">
  <link rel="alternate" type="application/rss+xml" title="RSS"
     href="https://vertx.io/feed.xml">
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-30144458-1', 'auto');
    ga('create', 'UA-71153120-1', 'auto', 'tracker');
    ga('send', 'pageview');
    ga('tracker.send', 'pageview');
  </script>
</head>
<body>

<a href="http://www.reactivemanifesto.org/" id="reactive-manifesto-banner">
  <img style="border: 0; position: fixed; right: 0; top:0; z-index: 9000"
    src="https://d379ifj7s9wntv.cloudfront.net/reactivemanifesto/images/ribbons/we-are-reactive-black-right.png">
</a>

<a id="skippy" class="sr-only sr-only-focusable" href="#content"><div class="container"><span class="skiplink-text">Skip to main content</span></div></a>

<header class="navbar navbar-default navbar-static-top" id="top" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#vertx-navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="https://vertx.io/" class="navbar-brand"><img alt="Brand" src="https://vertx.io/assets/logo-sm.png"></a>
    </div>
    <nav class="collapse navbar-collapse" id="vertx-navbar-collapse">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="https://start.vertx.io/">Starter</a></li>
        <li><a href="https://vertx.io/download/">Download</a></li>
        <li><a href="https://how-to.vertx.io/">How-to</a></li>
        <li><a href="https://vertx.io/docs/3.8.5/">Documentation</a></li>
        <li><a href="https://github.com/vert-x3/wiki/wiki">Wiki</a></li>
        <li><a href="https://vertx.io/community/">Community</a></li>
        <li><a href="https://vertx.io/materials/">Materials</a></li>
        <li><a href="https://vertx.io/blog/">Blog</a></li>
      </ul>
    </nav>
  </div>
</header>



  <div class="page-header" id="content">
    <div class="container">
      <div class="row">
        <div class="col-sm-12">
          <h1>Vert.x Web API Service</h1>
          
        </div>
      </div>
    </div>
  </div>




<div id="content">
  <div class="container docs-content">
    <div class="row">
      <div class="col-sm-12 col-md-push-9 col-md-3 hidden-xs hidden-sm">
        <div id="sidebar" data-spy="affix">
          <ul class="sectlevel1">
<li><a href="#_using_vert_x_api_service">Using Vert.x API Service</a></li>
<li><a href="#_recap_on_vert_x_web_api_contract">Recap on Vert.x Web API Contract</a></li>
<li><a href="#_define_your_service_interface">Define your Service interface</a></li>
<li><a href="#_implement_your_service">Implement your service</a>
<ul class="sectlevel2">
<li><a href="#_the_code_operationrequest_code_data_object">The <code>OperationRequest</code> data object</a></li>
<li><a href="#_the_code_operationresponse_code_data_object">The <code>OperationResponse</code> data object</a></li>
</ul>
</li>
<li><a href="#_mount_to_router_factory">Mount to Router Factory</a>
<ul class="sectlevel2">
<li><a href="#_using_the_extension_code_x_vertx_event_bus_code">Using the extension <code>x-vertx-event-bus</code></a></li>
</ul>
</li>
<li><a href="#_run_the_service">Run the service</a></li>
</ul>
        </div>
      </div>
      <div class="col-sm-12 col-md-pull-3 col-md-9">
        <div class="toc hidden-md hidden-lg">
          <h2>Table of Contents</h2>
          <ul class="sectlevel1">
<li><a href="#_using_vert_x_api_service">Using Vert.x API Service</a></li>
<li><a href="#_recap_on_vert_x_web_api_contract">Recap on Vert.x Web API Contract</a></li>
<li><a href="#_define_your_service_interface">Define your Service interface</a></li>
<li><a href="#_implement_your_service">Implement your service</a>
<ul class="sectlevel2">
<li><a href="#_the_code_operationrequest_code_data_object">The <code>OperationRequest</code> data object</a></li>
<li><a href="#_the_code_operationresponse_code_data_object">The <code>OperationResponse</code> data object</a></li>
</ul>
</li>
<li><a href="#_mount_to_router_factory">Mount to Router Factory</a>
<ul class="sectlevel2">
<li><a href="#_using_the_extension_code_x_vertx_event_bus_code">Using the extension <code>x-vertx-event-bus</code></a></li>
</ul>
</li>
<li><a href="#_run_the_service">Run the service</a></li>
</ul>
        </div>
        <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x Web API Service helps you routing the API requests incoming from a Vert.x Web Router built with <a href="https://vertx.io/docs/3.8.5/vertx-web-api-contract/java/">Vert.x Web API Contract Router Factory</a> to event bus.
Event Bus provides itself important features like load balancing and distribution of requests across different Vert.x instances. We encourage you to give a look at <a href="https://vertx.io/docs/3.8.5/vertx-core/java/#event_bus">Event Bus documentation</a></p>
</div>
<div class="paragraph">
<p>It&#8217;s based on same concept of <a href="https://vertx.io/docs/3.8.5/vertx-service-proxy/java/">Vert.x service proxies</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_vert_x_api_service">Using Vert.x API Service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use Vert.x API Service, add the following dependency to the <em>dependencies</em> section of your build descriptor:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Maven (in your <code>pom.xml</code>):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
 <span class="tag">&lt;groupId&gt;</span>io.vertx<span class="tag">&lt;/groupId&gt;</span>
 <span class="tag">&lt;artifactId&gt;</span>vertx-codegen<span class="tag">&lt;/artifactId&gt;</span>
 <span class="tag">&lt;version&gt;</span>3.8.5<span class="tag">&lt;/version&gt;</span>
 <span class="tag">&lt;classifier&gt;</span>processor<span class="tag">&lt;/classifier&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
 <span class="tag">&lt;groupId&gt;</span>io.vertx<span class="tag">&lt;/groupId&gt;</span>
 <span class="tag">&lt;artifactId&gt;</span>vertx-web-api-service<span class="tag">&lt;/artifactId&gt;</span>
 <span class="tag">&lt;version&gt;</span>3.8.5<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle &lt; 5 (in your <code>build.gradle</code> file):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
 compile <span class="string"><span class="delimiter">'</span><span class="content">io.vertx:vertx-codegen:3.8.5:processor</span><span class="delimiter">'</span></span>
 compile <span class="string"><span class="delimiter">'</span><span class="content">io.vertx:vertx-web-api-service:3.8.5</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle &gt;= 5 (in your <code>build.gradle</code> file):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
 annotationProcessor <span class="string"><span class="delimiter">'</span><span class="content">io.vertx:vertx-codegen:3.8.5:processor</span><span class="delimiter">'</span></span>
 annotationProcessor <span class="string"><span class="delimiter">'</span><span class="content">io.vertx:vertx-web-api-service:3.8.5</span><span class="delimiter">'</span></span>
 compile <span class="string"><span class="delimiter">'</span><span class="content">io.vertx:vertx-web-api-service:3.8.5</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You need to import <code>vertx-codegen</code> to trigger the code generation from annotated interfaces</p>
</div>
<div class="paragraph">
<p>If you want to use the interface you write in different languages, you will need to add the <em>language</em> dependency such as
<code>vertx-lang-groovy</code> for Groovy.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recap_on_vert_x_web_api_contract">Recap on Vert.x Web API Contract</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x Web API Contract helps you to build a Vert.x Web router compliant to an OpenAPI spec, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">routerFactory.addHandlerByOperationId(<span class="string"><span class="delimiter">&quot;</span><span class="content">operationId</span><span class="delimiter">&quot;</span></span>, routingContext -&gt; {
  RequestParameters parameters = routingContext.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">parsedParameters</span><span class="delimiter">&quot;</span></span>);
  <span class="comment">// Process the request</span>
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>With Vert.x Web API Service you can define an event bus service that connects automatically to the router factory, allowing automatic request routing to Vert.x Event Bus.</p>
</div>
<div class="paragraph">
<p>We encourage you to read <a href="https://vertx.io/docs/3.8.5/vertx-service-proxy/java/">Service Proxy documentation</a> before going further</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_define_your_service_interface">Define your Service interface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s start with defining your service interface. We want to define the service interface for this OpenAPI operations definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">/api/transactions</span>:
 <span class="key">get</span>:
   <span class="key">operationId</span>: <span class="string"><span class="content">getTransactionsList</span></span>
   <span class="key">parameters</span>:
     - <span class="string"><span class="content">name: from</span></span>
       <span class="key">in</span>: <span class="string"><span class="content">query</span></span>
       <span class="key">style</span>: <span class="string"><span class="content">form</span></span>
       <span class="key">explode</span>: <span class="string"><span class="content">false</span></span>
       <span class="key">required</span>: <span class="string"><span class="content">false</span></span>
       <span class="key">schema</span>:
         <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
     - <span class="string"><span class="content">name: to</span></span>
       <span class="key">in</span>: <span class="string"><span class="content">query</span></span>
       <span class="key">style</span>: <span class="string"><span class="content">form</span></span>
       <span class="key">explode</span>: <span class="string"><span class="content">false</span></span>
       <span class="key">required</span>: <span class="string"><span class="content">false</span></span>
       <span class="key">schema</span>:
         <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
   <span class="key">responses</span>: <span class="string"><span class="content">...</span></span>
 <span class="key">put</span>:
   <span class="key">operationId</span>: <span class="string"><span class="content">putTransaction</span></span>
   <span class="key">requestBody</span>:
     <span class="key">required</span>: <span class="string"><span class="content">true</span></span>
     <span class="key">content</span>:
       <span class="key">application/json</span>:
         <span class="key">schema</span>:
           <span class="key">type</span>: <span class="string"><span class="content">object</span></span>
           <span class="key">properties</span>:
             <span class="key">from</span>:
               <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
               <span class="key">format</span>: <span class="string"><span class="content">email</span></span>
             <span class="key">to</span>:
               <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
               <span class="key">format</span>: <span class="string"><span class="content">email</span></span>
             <span class="key">value</span>:
               <span class="key">type</span>: <span class="string"><span class="content">number</span></span>
               <span class="key">format</span>: <span class="string"><span class="content">double</span></span>
           <span class="key">additionalProperties</span>: <span class="string"><span class="content">false</span></span>
           <span class="key">required</span>:
             - <span class="string"><span class="content">from</span></span>
             - <span class="string"><span class="content">to</span></span>
             - <span class="string"><span class="content">value</span></span>
   <span class="key">responses</span>: <span class="string"><span class="content">...</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we can build the interface that specifies a <strong>TransactionService</strong> that handles <em>getTransactionsList</em> and <em>putTransaction</em> operations. For each operation you need to write a method with name corresponding to operation id with following parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Last parameter must be a <code>Handler&lt;AsyncResult&lt;OperationResponse&gt;&gt;</code></p>
</li>
<li>
<p>Second to last parameter must be a <code><a href="../../apidocs/io/vertx/ext/web/api/OperationRequest.html">OperationRequest</a></code></p>
</li>
<li>
<p>All parameters from first to second to last (excluded) are extracted from <code><a href="../../apidocs/io/vertx/ext/web/api/RequestParameter.html">RequestParameter</a></code> with specified type automatically, but they need to respect <a href="https://vertx.io/docs/3.8.5/vertx-service-proxy/java/#_restrictions_for_service_interface">service proxy restrictions</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@WebApiServiceGen</span>
<span class="type">interface</span> <span class="class">TransactionService</span> {
 <span class="type">void</span> getTransactionsList(<span class="predefined-type">String</span> from, <span class="predefined-type">String</span> to, OperationRequest context, <span class="predefined-type">Handler</span>&lt;AsyncResult&lt;OperationResponse&gt;&gt; resultHandler);
 <span class="type">void</span> putTransaction(JsonObject body, OperationRequest context, <span class="predefined-type">Handler</span>&lt;AsyncResult&lt;OperationResponse&gt;&gt; resultHandler);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you receive a request at <code>TransactionService.getTransactionsList()</code> the generated service handler will automatically extract <code>from</code> and <code>to</code> parameter (if present) from <code><a href="../../apidocs/io/vertx/ext/web/api/OperationRequest.html">OperationRequest</a></code>. In <code>putTransaction()</code> we use the <code>body</code> parameter name to extract the json body.</p>
</div>
<div class="paragraph">
<p>The service handler is also capable to translate <code>JsonObject</code> to Vert.x data objects automatically, for example if you have a <code>Transaction</code> data object that matches the json schema above, you can rewrite the <code>putTransaction()</code> signature as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">void</span> putTransaction(Transaction body, OperationRequest context, <span class="predefined-type">Handler</span>&lt;AsyncResult&lt;OperationResponse&gt;&gt; resultHandler);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that generated service handler matches method parameters with spec&#8217;s parameter name and not with the location of parameter, so avoid duplicated parameter names in your spec</p>
</div>
<div class="paragraph">
<p>We also encourage to extract with <code><a href="../../apidocs/io/vertx/ext/web/api/RequestParameter.html">RequestParameter</a></code> parameters that uses json schema allOf/anyOf/oneOf/not keywords because the extraction can produce undefined behaviours</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implement_your_service">Implement your service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now you can implement your service. The <code><a href="../../apidocs/io/vertx/ext/web/api/OperationRequest.html">OperationRequest</a></code> object contains headers and parameters maps.</p>
</div>
<div class="paragraph">
<p>To write the request you must call the <code>resultHandler</code> with an <code><a href="../../apidocs/io/vertx/ext/web/api/OperationResponse.html">OperationResponse</a></code>. To construct the <code><a href="../../apidocs/io/vertx/ext/web/api/OperationResponse.html">OperationResponse</a></code> you can use some handy methods like <code><a href="../../apidocs/io/vertx/ext/web/api/OperationResponse.html#completedWithJson-io.vertx.core.buffer.Buffer-">OperationResponse.completedWithJson</a></code> or <code><a href="../../apidocs/io/vertx/ext/web/api/OperationResponse.html#completedWithPlainText-io.vertx.core.buffer.Buffer-">OperationResponse.completedWithPlainText</a></code></p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">resultHandler.handle(
  <span class="predefined-type">Future</span>.succeededFuture(
    OperationResponse.completedWithPlainText(<span class="predefined-type">Buffer</span>.buffer(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello world!</span><span class="delimiter">&quot;</span></span>))
  )
);</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_the_code_operationrequest_code_data_object">The <code>OperationRequest</code> data object</h3>
<div class="paragraph">
<p><code>OperationRequest</code> it&#8217;s a <em>serializable</em> version of <code>RoutingContext</code>. It doesn&#8217;t contain all data encapsulated in <code>RoutingContext</code>. It transports to your service:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="../../apidocs/io/vertx/ext/web/api/OperationRequest.html#getHeaders--">getHeaders</a></code>: Headers of the request</p>
</li>
<li>
<p><code><a href="../../apidocs/io/vertx/ext/web/api/OperationRequest.html#getParams--">getParams</a></code>: Contains <code>routingContext.get("parsedParameters")</code></p>
</li>
<li>
<p><code><a href="../../apidocs/io/vertx/ext/web/api/OperationRequest.html#getUser--">getUser</a></code>: Contains <code>routingContext.user().principal()</code>, null if no user is authenticated</p>
</li>
<li>
<p><code><a href="../../apidocs/io/vertx/ext/web/api/OperationRequest.html#getExtra--">getExtra</a></code>: Contains an extra configurable payload</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can configure a lambda that builds the extra payload with <code><a href="../../apidocs/io/vertx/ext/web/api/contract/RouterFactory.html#setExtraOperationContextPayloadMapper-java.util.function.Function-">setExtraOperationContextPayloadMapper</a></code></p>
</div>
</div>
<div class="sect2">
<h3 id="_the_code_operationresponse_code_data_object">The <code>OperationResponse</code> data object</h3>
<div class="paragraph">
<p><code>OperationResponse</code> is composed by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Headers of the response</p>
</li>
<li>
<p>Status code/Status message</p>
</li>
<li>
<p>Body as a payload. If you set the payload as null no body will be sent</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mount_to_router_factory">Mount to Router Factory</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that your service is ready you need to mount it to <code><a href="../../apidocs/io/vertx/ext/web/api/contract/openapi3/OpenAPI3RouterFactory.html">OpenAPI3RouterFactory</a></code>. When you use one of the methods below, the router factory mounts an handler that routes the request through the event bus to the service at the address specified. Pay attention to specify the correct address to event bus endpoint.</p>
</div>
<div class="paragraph">
<p>You have four methods to match the service with router operation handlers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Mount manually every operation to a specified address with <code><a href="../../apidocs/io/vertx/ext/web/api/contract/openapi3/OpenAPI3RouterFactory.html#mountOperationToEventBus-java.lang.String-java.lang.String-">mountOperationToEventBus</a></code></p>
</li>
<li>
<p>Mount operations matching a tag[<a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md#operation-object" class="bare">https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md#operation-object</a>] to a specified address with <code><a href="../../apidocs/io/vertx/ext/web/api/contract/openapi3/OpenAPI3RouterFactory.html#mountServiceFromTag-java.lang.String-java.lang.String-">mountServiceFromTag</a></code>.</p>
</li>
<li>
<p>Specify the class interface and the address of the service with <code><a href="../../apidocs/io/vertx/ext/web/api/contract/openapi3/OpenAPI3RouterFactory.html#mountServiceInterface-java.lang.Class-java.lang.String-">mountServiceInterface</a></code>. This method introspects the interface public methods and mounts all matching method names with operation ids</p>
</li>
<li>
<p>Specify inside the OpenAPI specification the <code>x-vertx-event-bus</code> extension for operations you want to route to your service and scan all operations that contains it with <code><a href="../../apidocs/io/vertx/ext/web/api/contract/openapi3/OpenAPI3RouterFactory.html#mountServicesFromExtensions--">mountServicesFromExtensions</a></code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We suggest you to use the extension <code>x-vertx-event-bus</code> over all other methods. If you don&#8217;t want to modify your spec adding extensions, we recommend you to use <code><a href="../../apidocs/io/vertx/ext/web/api/contract/openapi3/OpenAPI3RouterFactory.html#mountServiceInterface-java.lang.Class-java.lang.String-">mountServiceInterface</a></code></p>
</div>
<div class="sect2">
<h3 id="_using_the_extension_code_x_vertx_event_bus_code">Using the extension <code>x-vertx-event-bus</code></h3>
<div class="paragraph">
<p>The <code>x-vertx-event-bus</code> can be configured both in path item object or in operation object. It can be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A string containing the address of service</p>
</li>
<li>
<p>An object containing:</p>
<div class="ulist">
<ul>
<li>
<p>The field <code>address</code> that specifies the address of the service</p>
</li>
<li>
<p>The field <code>method</code> that specifies the interface method name (valid only when you specify it in operation object)</p>
</li>
<li>
<p>The delivery options <code>timeout</code> and <code>headers</code> (Look at <code><a href="../../apidocs/io/vertx/core/eventbus/DeliveryOptions.html">DeliveryOptions</a></code>)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example if I want to route <em>getTransactionsList</em> to <code>TransactionService</code> mounted at event bus address <code>transaction_service.my_application</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">/api/transactions</span>:
 <span class="key">get</span>:
   <span class="key">operationId</span>: <span class="string"><span class="content">getTransactionsList</span></span>
   <span class="key">parameters</span>: <span class="string"><span class="content">...</span></span>
   <span class="key">responses</span>: <span class="string"><span class="content">...</span></span>
   <span class="key">x-vertx-event-bus</span>: <span class="string"><span class="content">transaction_service.my_application</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">/api/transactions</span>:
 <span class="key">get</span>:
   <span class="key">operationId</span>: <span class="string"><span class="content">getTransactionsList</span></span>
   <span class="key">parameters</span>: <span class="string"><span class="content">...</span></span>
   <span class="key">responses</span>: <span class="string"><span class="content">...</span></span>
   <span class="key">x-vertx-event-bus</span>:
     <span class="key">address</span>: <span class="string"><span class="content">transaction_service.my_application</span></span>
     <span class="key">method</span>: <span class="string"><span class="content">getTransactionsList</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can specify both in path item and operation the extension and router factory will take care of merging it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">/api/transactions</span>:
 <span class="key">x-vertx-event-bus</span>:
   <span class="key">address</span>: <span class="string"><span class="content">transaction_service.my_application</span></span>
   <span class="key">timeout</span>: <span class="string"><span class="content">1000</span></span>
 <span class="key">get</span>:
   <span class="key">operationId</span>: <span class="string"><span class="content">getTransactionsList</span></span>
   <span class="key">parameters</span>: <span class="string"><span class="content">...</span></span>
   <span class="key">responses</span>: <span class="string"><span class="content">...</span></span>
 <span class="key">post</span>:
   <span class="key">operationId</span>: <span class="string"><span class="content">postTransaction</span></span>
   <span class="key">parameters</span>: <span class="string"><span class="content">...</span></span>
   <span class="key">responses</span>: <span class="string"><span class="content">...</span></span>
   <span class="key">x-vertx-event-bus</span>:
     <span class="key">method</span>: <span class="string"><span class="content">postTransactionToDb</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>getTransactionList</code> operation is mapped to service at address <code>transaction_service.my_application</code> and method <code>getTransactionList</code></p>
</li>
<li>
<p><code>postTransaction</code> operation is mapped to service at address <code>transaction_service.my_application</code> and method <code>postTransactionToDb</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Then you can call <code><a href="../../apidocs/io/vertx/ext/web/api/contract/openapi3/OpenAPI3RouterFactory.html#mountServicesFromExtensions--">mountServicesFromExtensions</a></code> that scans entire spec and mounts the handlers that route to your service the requests</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_run_the_service">Run the service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now you can register your service to event bus:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">TransactionService service = <span class="keyword">new</span> TransactionServiceImpl();
<span class="directive">final</span> ServiceBinder serviceBinder = <span class="keyword">new</span> ServiceBinder(vertx).setAddress(<span class="string"><span class="delimiter">&quot;</span><span class="content">address</span><span class="delimiter">&quot;</span></span>);
MessageConsumer&lt;JsonObject&gt; serviceConsumer = serviceBinder.register(TransactionService.class, service);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more info look at <a href="https://vertx.io/docs/3.8.5/vertx-service-proxy/java/#_exposing_your_service">Vert.x service proxy documentation</a></p>
</div>
</div>
</div>

        

        
          <div id="footer">
            <div id="footer-text">
              
                Last updated 2020-01-22 23:22:00 CET
              
              
            </div>
          </div>
        
      </div>
    </div>
  </div>
</div>

<footer>
  <div class="container">
    <div class="row">
      <div class="col-xs-4 col-sm-4 col-md-2 col-lg-2">
        <h2>Eclipse Vert.x</h2>
        <ul class="list-unstyled">
          <li><a href="https://vertx.io/">Home</a></li>
          <li><a href="https://vertx.io/download/">Download</a></li>
          <li><a href="https://vertx.io/docs/3.8.5/">Documentation</a></li>
          <li><a href="https://github.com/vert-x3/wiki/wiki">Wiki</a></li>
          <li><a href="https://vertx.io/blog/">Blog</a></li>
          <li><a href="https://vertx.io/vertx2/" class="vertx-2-link">Vert.x 2</a></li>
        </ul>
      </div>
      <div class="col-xs-4 col-sm-4 col-md-2 col-lg-2">
        <h2>Community</h2>
        <ul class="list-unstyled">
          <li><a href="https://vertx.io/community/">Help &amp; Contributors</a></li>
          <li><a href="https://vertx.io/materials/">Learning materials</a></li>
          <li><a href="https://groups.google.com/forum/?fromgroups#!forum/vertx">User Group</a></li>
          <li><a href="https://groups.google.com/forum/?fromgroups#!forum/vertx-dev">Developer Group</a></li>
        </ul>
      </div>
      <div class="col-xs-4 col-sm-4 col-md-2 col-lg-2">
        <h2>Eclipse</h2>
        <ul class="list-unstyled">
          <li><a href="http://www.eclipse.org/">Eclipse Foundation</a></li>
          <li><a href="https://eclipse.org/legal/privacy.php">Privacy Policy</a></li>
          <li><a href="https://eclipse.org/legal/termsofuse.php">Terms of Use</a></li>
          <li><a href="https://eclipse.org/legal/copyright.php">Copyright Agent</a></li>
          <li><a href="http://www.eclipse.org/legal">Legal Resources</a></li>
        </ul>
      </div>

      <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 copyright">
        <p>Eclipse Vert.x is open source and dual-licensed under the <a href="http://www.eclipse.org/legal/epl-v20.html">Eclipse Public License 2.0</a> and <a href="https://www.apache.org/licenses/LICENSE-2.0.html">Apache License 2.0</a>.</p>
        <p>This website is licensed under the <a href="http://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA 3.0 License</a>.<br>
        Design by <a href="https://www.michel-kraemer.com">Michel Kr&auml;mer</a>.</p>
        <div class="row">
          <div class="col-sm-12 col-md-5 col-md-offset-1 col-lg-offset-2">
            <a href="http://eclipse.org">
            <img class="logo eclipse-logo" src="https://vertx.io/assets/eclipse_logo_grey_small.png" width="204" height="48">
            </a>
          </div>
          <div class="col-sm-12 col-md-5 col-md-offset-1 col-lg-offset-0">
            <a href="http://cloudbees.com">
            <img class="logo cloudbees-logo" src="https://vertx.io/assets/Button-Built-on-CB-1-grey.png" width="180" height="48">
           </a>
          </div>
          <div class="col-sm-12 col-md-5 col-md-offset-7 jprofiler">
            <a href="http://www.ej-technologies.com/products/jprofiler/overview.html"
            style="text-decoration:none">
            <img class="logo jprofiler-logo" src="https://vertx.io/assets/jprofiler-logo.png" width="48" height="48"><span class="jprofiler-logo">&nbsp; JPROFILER</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="https://vertx.io/javascripts/bootstrap.min.js"></script>
<script src="https://vertx.io/javascripts/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>



<script src="https://vertx.io/javascripts/sidebar.js"></script>


<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#64386b",
      "text": "#ffcdfd"
    },
    "button": {
      "background": "transparent",
      "text": "#f8a8ff",
      "border": "#f8a8ff"
    }
  },
  "content": {
    "message": "This website uses anonymous cookies to ensure we provide you the best experience. ",
    "link": "Opt out!",
    "href": "https://tools.google.com/dlpage/gaoptout/"
  }
})});
</script>
</body>
</html>

