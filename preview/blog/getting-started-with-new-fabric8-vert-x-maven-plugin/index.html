<!DOCTYPE html><html lang=en><head><title>Getting started with new fabric8 Vert.x Maven Plugin</title><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta content="width=device-width,initial-scale=1" name=viewport><meta content="Eclipse Vert.x is a tool-kit for building reactive applications on the JVM." name=description><link href=https://vertx.io/preview/stylesheets/main.css media=screen rel=stylesheet><link href=https://vertx.io/preview/stylesheets/font-awesome.min.css media=screen rel=stylesheet><link href=https://vertx.io/preview/javascripts/styles/rainbow.min.css media=screen rel=stylesheet><!--[if lt IE 9]><script src="http://static.jboss.org/theme/js/libs/html5/pre3.6/html5.min.js"></script><![endif]--><link rel=apple-touch-icon sizes=57x57 href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/apple-touch-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/apple-touch-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/apple-touch-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/apple-touch-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/apple-touch-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/apple-touch-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/apple-touch-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/apple-touch-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/apple-touch-icon-180x180.png><link rel=icon type=image/png href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/android-chrome-192x192.png sizes=192x192><link rel=icon type=image/png href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/favicon-16x16.png sizes=16x16><link rel=manifest href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/manifest.json><link rel=mask-icon href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content=#7d3194><meta name=msapplication-TileImage content=https://vertx.io/preview/assets/favicons/vertx-favicon-7/mstile-144x144.png><meta name=theme-color content=#ffffff><link href="https://fonts.googleapis.com/css?family=Ubuntu:400,500,700,400italic" rel=stylesheet type=text/css><link rel=alternate type=application/rss+xml title=RSS href=https://vertx.io/preview/feed.xml><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-30144458-1', 'auto');
    ga('create', 'UA-71153120-1', 'auto', 'tracker');
    ga('send', 'pageview');
    ga('tracker.send', 'pageview');</script></head><body><a href="http://www.reactivemanifesto.org/" id=reactive-manifesto-banner><img style="border: 0; position: fixed; right: 0; top:0; z-index: 9000" src=https://d379ifj7s9wntv.cloudfront.net/reactivemanifesto/images/ribbons/we-are-reactive-black-right.png></a> <a id=skippy class="sr-only sr-only-focusable" href=#content><div class=container><span class=skiplink-text>Skip to main content</span></div></a><header class="navbar navbar-default navbar-static-top" id=top role=banner><div class=container><div class=navbar-header><button class="navbar-toggle collapsed" type=button data-toggle=collapse data-target=#vertx-navbar-collapse><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a href="https://vertx.io/preview/" class=navbar-brand><img alt=Brand src=https://vertx.io/preview/assets/logo-sm.png></a></div><nav class="collapse navbar-collapse" id=vertx-navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=http://start.vertx.io>Starter</a></li><li><a href="https://vertx.io/preview/download/">Download</a></li><li><a href="https://vertx.io/preview/docs/">Documentation</a></li><li><a href=https://github.com/vert-x3/wiki/wiki>Wiki</a></li><li><a href="https://vertx.io/preview/community/">Community</a></li><li><a href="https://vertx.io/preview/materials/">Materials</a></li><li><a href="https://vertx.io/preview/blog/">Blog</a></li></ul></nav></div></header><div class=container><div class="row blog"><article class="col-xs-12 blog-post"><h2 class=blog-post-title>Getting started with new fabric8 Vert.x Maven Plugin</h2><p class=blog-post-meta>7th December 2016 by <a href=http://github.com/kameshsampath>kameshsampath</a></p><article><p>The all new <a href=http://vmp.fabric8.io>fabric8 Vert.x Maven Plugin</a> allows you to setup, package, run, start, stop and redeploy easily with a very little configuration resulting in a less verbose <code>pom.xml</code>.</p><p><div class="admonition-block info"><table><tbody><tr><td class=admonition-icon><i class="admonition-icon fa fa-info-circle"></i></td><td class=content><span class=content>The plugin is developed under the <a href="https://fabric8.io/">fabric8</a> umbrella</span></td></tr></tbody></table></div></p><p>Traditionally Vert.x applications using <a href=http://maven.apache.org>Apache Maven</a> need to have one or more of the following plugins:</p><ul><li><a href="https://maven.apache.org/plugins/maven-shade-plugin/">Maven Shade Plugin</a> - aids in packaging a uber jar of Vert.x application with additional configurations to perform SPI combining, MANIFEST.MF entries etc.,</li><li><a href="http://www.mojohaus.org/exec-maven-plugin/">Maven Exec Plugin</a> - aids in starting the Vert.x application</li><li><a href="https://maven.apache.org/plugins/maven-ant-plugin/">Maven Ant Plugin</a> - aids in stopping the running Vert.x application</li></ul><p>Though these are great plugins and do what is required, but at the end of the day the developer is left with a verbose <code>pom.xml</code> which might become harder to maintain as the application or its configuration grows. Even if we decide to go this way and use those plugins, there are some things which can’t done or done easily:</p><ul><li><code>run</code> an application on foreground - which is a typical way during development where the application starts in foreground of <a href=http://maven.apache.org>Apache Maven</a> build and killed automatically once we hit <code>Ctrl + c</code>(or <code>CMD + c</code> on Mac)</li><li><code>redeploy</code> is one of the coolest feature of Vert.x allowing us to perform hot deployments. Still we can manage to do this with IDE support but not natively using <a href=http://maven.apache.org>Apache Maven</a> - typical cases where we disable <em>Automatic Builds</em> via IDE</li><li><code>setup</code> Vert.x applications with sensible defaults and required Vert.x dependencies e.g. vertx-core</li></ul><p>In this first blog of fabric8 Vert.x Maven Plugin series we will help you to get started with this new <a href=http://vmp.fabric8.io>fabric8 Vert.x Maven Plugin</a>, highlighting how this plugin helps alleviating the aforementioned pain points with a less verbose <code>pom.xml</code>.</p><p>The <a href=http://maven.apache.org>Apache Maven</a> plugin source code is available at <a href=https://github.com/fabric8io/vertx-maven-plugin>github</a> with <a href=http://maven.apache.org>Apache Maven</a> plugin documentation available at <a href=http://vmp.fabric8.io>fabric8 Vert.x Maven Plugin</a></p><p>The source code of the examples used in this blog are available at <a href=https://github.com/kameshsampath/vmp-blog>github</a></p><h2 id=let-s-set-it-up>Let’s set it up</h2><p>Its very easy to setup and get started. Let’s say you have a project called <em>vmp-blog</em> with the following content as part of your <code>pom.xml</code></p><script src=https://gist.github.com/kameshsampath/0e0cfc90ea3cb9d69553ee9901dfd796.js></script><p>from the project directory just run the following command:</p><pre><code class="hljs bash">mvn io.fabric8:vertx-maven-plugin:<span class=hljs-number>1.0</span>.<span class=hljs-number>0</span>:setup</code></pre><p>On successful execution of the above command the project’s <code>pom.xml</code> will be updated:</p><script src=https://gist.github.com/kameshsampath/3c2e96d98f1e16d0f7a0501c05ce0d12.js></script><p>The command did the following for you on the project:</p><ul><li>added couple of properties<ul><li><code>fabric8.vertx.plugin.version</code> - the latest fabric8 vert.x maven plugin version</li><li><code>vertx.version</code> - the latest Vert.x framework version</li></ul></li><li>added the Vert.x dependency BOM and vertx-core dependency corresponding to <code>vertx.version</code></li><li>added <code>vertx-maven-plugin</code> with a single execution for goals <a href=https://vmp.fabric8.io/#vertx:initalize>initialize</a> and <a href=https://vmp.fabric8.io/#vertx:package>package</a></li></ul><p>The source code created by this step is available <a href=https://github.com/kameshsampath/vmp-blog/tree/setup>here</a></p><p>Et voilà, you are now all set to go with your Vert.x application building with <a href=http://maven.apache.org>Apache Maven</a>!!</p><h2 id=let-s-package-it>Let’s package it</h2><p>Now that we have set up our project to use <code>vertx-maven-plugin</code>, lets add a simple verticle and package the Vert.x application as typical <em>uber</em> jar (in the Vert.x world we call them <em>fat</em> jars). The source code of this section is available <a href=https://github.com/kameshsampath/vmp-blog/tree/package>here</a>.</p><p>To make <code>package</code> work correctly we need to add property called <code>vertx.verticle</code>, which will be used by the vertx-maven-plugin to set the <code>Main-Verticle:</code> attribute of the <code>MANIFEST.MF</code>. Please refer to the documentation of <a href=https://vmp.fabric8.io/#vertx:package>package</a> for other possible configurations. There is also a <a href=https://vmp.fabric8.io/#vertx:examples>examples</a> section of the vertx-maven-plugin which provides various samples snippets.</p><p>The updated <code>pom.xml</code> with the added property <code>vertx-maven-plugin</code> is shown below:</p><p><div class="admonition-block note"><table><tbody><tr><td class=admonition-icon><i class="admonition-icon fa fa-comment"></i></td><td class=content><span class=content>Only updated section is shown below, rest of the pom.xml is same as above</span></td></tr></tbody></table></div></p><script src=https://gist.github.com/kameshsampath/24a1ed6a377b118f06af2c4b4ddf0ca0.js></script><p>To package the Vert.x application, run the following <a href=http://maven.apache.org>Apache Maven</a> command from the project directory:</p><pre><code class="hljs bash">mvn clean package</code></pre><p>On successful run of the above command you should see the file with name <code>${project.finalName}.jar</code> created in the <code>${project.build.directory}</code>, you could now do the following to start and run the Vert.x application.</p><pre><code class="hljs bash">java -jar <span class=hljs-variable>${project.build.directory}</span>/<span class=hljs-variable>${project.finalName}</span>.jar</code></pre><p>The generated <code>MANIFEST.MF</code> file is as shown below:</p><pre><code class=hljs>Main-Class                               io<span class=hljs-class>.vertx</span><span class=hljs-class>.core</span><span class=hljs-class>.Launcher</span>
Main-Verticle                            io<span class=hljs-class>.fabric8</span><span class=hljs-class>.blog</span><span class=hljs-class>.MainVerticle</span>
Manifest-Version                         <span class=hljs-number>1.0</span></code></pre><p>The source code up to now is available in <a href=https://github.com/kameshsampath/vmp-blog/tree/package>here</a></p><h3 id=spi-combination>SPI Combination</h3><p>The <code>package</code> goal by default does a SPI combination, lets say you have a service file called <code>com.fasterxml.jackson.core.JsonFactory</code> in <code>${project.basedir}/src/main/resources/META-INF/services</code> with contents:</p><pre><code class=hljs>foo.bar.baz.MyImpl
<span class=hljs-variable>${combine}</span></code></pre><p>During packaging, if the <a href=http://vmp.fabric8.io>fabric8 Vert.x Maven Plugin</a> finds another <code>com.fasterxml.jackson.core.JsonFactory</code> service definition file within the project dependencies with content <em>foo.bar.baz2.MyImpl2</em>, then it merges the content into <code>com.fasterxml.jackson.core.JsonFactory</code> of <code>${project.basedir}/src/main/resources/META-INF/services</code>, resulting in the following content:</p><pre><code class=hljs>foo<span class=hljs-class>.bar</span><span class=hljs-class>.baz</span><span class=hljs-class>.MyImpl</span>
foo<span class=hljs-class>.bar</span><span class=hljs-class>.baz2</span><span class=hljs-class>.MyImpl2</span></code></pre><p>The position of <code>${combine}</code> controls the ordering of the merge, since we added <code>${combine}</code> below <em>foo.bar.baz.MyImpl</em> all other SPI definitions will be appended below <em>foo.bar.baz.MyImpl</em></p><h2 id=what-s-next->What’s next ?</h2><p>It’s good to have the jar packaged and run using <code>java -jar uber-jar</code>, but when doing typical development you don’t want to do frequent <a href=http://maven.apache.org>Apache Maven</a> packaging and wish to see your changes automatically redeployed.</p><p>Don’t worry!!! As part of <a href=http://vmp.fabric8.io>fabric8 Vert.x Maven Plugin</a> we have added the incremental builder to <a href=http://maven.apache.org>Apache Maven</a> build, which will watch for your source and resource changes to perform automatic re-build and delegate the redeployment to Vert.x.</p><p>Run, redeploy and other features of the <a href=http://vmp.fabric8.io>fabric8 Vert.x Maven Plugin</a> will be explored in detail in the next part of this series, until then have fun with <a href=http://vmp.fabric8.io>fabric8 Vert.x Maven Plugin</a>!!</p></article></article></div><div class=row><div class=col-xs-12 id=disqus_thread></div></div><script>var disqus_config = function () {
  this.page.url = "https://vertx.io/preview/blog/getting-started-with-new-fabric8-vert-x-maven-plugin/";
  this.page.identifier = "/blog/getting-started-with-new-fabric8-vert-x-maven-plugin/";
  };
  (function() { // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = 'https://vertx.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
  })();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><footer><div class=container><div class=row><div class="col-xs-4 col-sm-4 col-md-2 col-lg-2"><h2>Eclipse Vert.x</h2><ul class=list-unstyled><li><a href="https://vertx.io/preview/">Home</a></li><li><a href="https://vertx.io/preview/download/">Download</a></li><li><a href="https://vertx.io/preview/docs/">Documentation</a></li><li><a href=https://github.com/vert-x3/wiki/wiki>Wiki</a></li><li><a href="https://vertx.io/preview/blog/">Blog</a></li><li><a href="https://vertx.io/preview/vertx2/" class=vertx-2-link>Vert.x 2</a></li></ul></div><div class="col-xs-4 col-sm-4 col-md-2 col-lg-2"><h2>Community</h2><ul class=list-unstyled><li><a href="https://vertx.io/preview/community/">Help &amp; Contributors</a></li><li><a href="https://vertx.io/preview/materials/">Learning materials</a></li><li><a href=https://groups.google.com/forum/?fromgroups#!forum/vertx>User Group</a></li><li><a href=https://groups.google.com/forum/?fromgroups#!forum/vertx-dev>Developer Group</a></li></ul></div><div class="col-xs-4 col-sm-4 col-md-2 col-lg-2"><h2>Eclipse</h2><ul class=list-unstyled><li><a href="http://www.eclipse.org/">Eclipse Foundation</a></li><li><a href=https://eclipse.org/legal/privacy.php>Privacy Policy</a></li><li><a href=https://eclipse.org/legal/termsofuse.php>Terms of Use</a></li><li><a href=https://eclipse.org/legal/copyright.php>Copyright Agent</a></li><li><a href=http://www.eclipse.org/legal>Legal Resources</a></li></ul></div><div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 copyright"><p>Eclipse Vert.x is open source and dual-licensed under the <a href=http://www.eclipse.org/legal/epl-v20.html>Eclipse Public License 2.0</a> and <a href=https://www.apache.org/licenses/LICENSE-2.0.html>Apache License 2.0</a>.</p><p>This website is licensed under the <a href="http://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA 3.0 License</a>.<br>Design by <a href=https://www.michel-kraemer.com>Michel Kr&auml;mer</a>.</p><div class=row><div class="col-sm-12 col-md-5 col-md-offset-1 col-lg-offset-2"><a href=http://eclipse.org><img class="logo eclipse-logo" src=https://vertx.io/preview/assets/eclipse_logo_grey_small.png width=204 height=48></a></div><div class="col-sm-12 col-md-5 col-md-offset-1 col-lg-offset-0"><a href=http://cloudbees.com><img class="logo cloudbees-logo" src=https://vertx.io/preview/assets/Button-Built-on-CB-1-grey.png width=180 height=48></a></div><div class="col-sm-12 col-md-5 col-md-offset-7 jprofiler"><a href=http://www.ej-technologies.com/products/jprofiler/overview.html style=text-decoration:none><img class="logo jprofiler-logo" src=https://vertx.io/preview/assets/jprofiler-logo.png width=48 height=48><span class=jprofiler-logo>&nbsp; JPROFILER</span></a></div></div></div></div></div></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js></script><script src=https://vertx.io/preview/javascripts/bootstrap.min.js></script><script src=https://vertx.io/preview/javascripts/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>