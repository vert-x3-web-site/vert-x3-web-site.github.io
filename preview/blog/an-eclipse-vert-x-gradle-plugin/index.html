<!DOCTYPE html><html lang=en><head><title>An Eclipse Vert.x Gradle Plugin</title><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta content="width=device-width,initial-scale=1" name=viewport><meta content="Eclipse Vert.x is a tool-kit for building reactive applications on the JVM." name=description><link href=https://vertx.io/preview/stylesheets/main.css media=screen rel=stylesheet><link href=https://vertx.io/preview/stylesheets/font-awesome.min.css media=screen rel=stylesheet><link href=https://vertx.io/preview/javascripts/styles/rainbow.min.css media=screen rel=stylesheet><!--[if lt IE 9]><script src="http://static.jboss.org/theme/js/libs/html5/pre3.6/html5.min.js"></script><![endif]--><link rel=apple-touch-icon sizes=57x57 href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/apple-touch-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/apple-touch-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/apple-touch-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/apple-touch-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/apple-touch-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/apple-touch-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/apple-touch-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/apple-touch-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/apple-touch-icon-180x180.png><link rel=icon type=image/png href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/android-chrome-192x192.png sizes=192x192><link rel=icon type=image/png href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/favicon-16x16.png sizes=16x16><link rel=manifest href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/manifest.json><link rel=mask-icon href=https://vertx.io/preview/assets/favicons/vertx-favicon-7/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content=#7d3194><meta name=msapplication-TileImage content=https://vertx.io/preview/assets/favicons/vertx-favicon-7/mstile-144x144.png><meta name=theme-color content=#ffffff><link href="https://fonts.googleapis.com/css?family=Ubuntu:400,500,700,400italic" rel=stylesheet type=text/css><link rel=alternate type=application/rss+xml title=RSS href=https://vertx.io/preview/feed.xml><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-30144458-1', 'auto');
    ga('create', 'UA-71153120-1', 'auto', 'tracker');
    ga('send', 'pageview');
    ga('tracker.send', 'pageview');</script></head><body><a href="http://www.reactivemanifesto.org/" id=reactive-manifesto-banner><img style="border: 0; position: fixed; right: 0; top:0; z-index: 9000" src=https://d379ifj7s9wntv.cloudfront.net/reactivemanifesto/images/ribbons/we-are-reactive-black-right.png></a> <a id=skippy class="sr-only sr-only-focusable" href=#content><div class=container><span class=skiplink-text>Skip to main content</span></div></a><header class="navbar navbar-default navbar-static-top" id=top role=banner><div class=container><div class=navbar-header><button class="navbar-toggle collapsed" type=button data-toggle=collapse data-target=#vertx-navbar-collapse><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a href="https://vertx.io/preview/" class=navbar-brand><img alt=Brand src=https://vertx.io/preview/assets/logo-sm.png></a></div><nav class="collapse navbar-collapse" id=vertx-navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=http://start.vertx.io>Starter</a></li><li><a href="https://vertx.io/preview/download/">Download</a></li><li><a href="https://vertx.io/preview/docs/">Documentation</a></li><li><a href=https://github.com/vert-x3/wiki/wiki>Wiki</a></li><li><a href="https://vertx.io/preview/community/">Community</a></li><li><a href="https://vertx.io/preview/materials/">Materials</a></li><li><a href="https://vertx.io/preview/blog/">Blog</a></li></ul></nav></div></header><div class=container><div class="row blog"><article class="col-xs-12 blog-post"><h2 class=blog-post-title>An Eclipse Vert.x Gradle Plugin</h2><p class=blog-post-meta>28th September 2017 by <a href=http://github.com/jponge>jponge</a></p><article><p>Eclipse Vert.x is a versatile toolkit, and as such it does not have any strong opinion on the tools that you should be using.</p><p>Gradle is a popular build tool in the JVM ecosystem, and it is quite easy to use for building Vert.x project as <a href=https://github.com/vert-x3/vertx-examples/blob/master/gradle-verticles/gradle-verticle/build.gradle>show in one of the <code>vertx-examples</code> samples</a> where a so-called <em>fat Jar</em> is being produced.</p><p>The new <a href=https://plugins.gradle.org/plugin/io.vertx.vertx-plugin>Vert.x Gradle plugin</a> offers an <em>opinionated</em> plugin for building Vert.x applications with Gradle.</p><p>It automatically applies the following plugins:</p><ul><li><code>java</code> (and sets the source compatibility to Java 8),</li><li><code>application</code> + <code>shadow</code> to generate fat Jars with all dependencies bundled,</li><li><code>nebula-dependency-recommender-plugin</code> so that you can omit versions from modules from the the Vert.x stack.</li></ul><p>The plugin automatically adds <code>io.vertx:vertx-core</code> as a <code>compile</code> dependency, so you don’t need to do it.</p><p>The plugin provides a <code>vertxRun</code> task that can take advantage of the Vert.x auto-reloading capabilities, so you can just run it then have your code being automatically compiled and reloaded as you make changes.</p><h2 id=getting-started>Getting started</h2><p>A minimal <code>build.gradle</code> looks like:</p><pre><code class="hljs groovy">plugins {
  id <span class=hljs-string>'io.vertx.vertx-plugin'</span> version <span class=hljs-string>'0.0.4'</span>
}

repositories {
  jcenter()
}

vertx {
  mainVerticle = <span class=hljs-string>'sample.App'</span>
}</code></pre><p>Provided <code>sample.App</code> is a Vert.x verticle, then:</p><ol><li><code>gradle shadowJar</code> builds an executable Jar with all dependencies: <code>java -jar build/libs/simple-project-fat.jar</code>, and</li><li><code>gradle vertxRun</code> starts the application and automatically recompiles (<code>gradle classes</code>) and reloads the code when any file under <code>src/</code> is being added, modified or deleted.</li></ol><h2 id=using-with-kotlin-or-groovy-or->Using with Kotlin (or Groovy, or…)</h2><p>The plugin integrates well with plugins that add configurations and tasks triggered by the <code>classes</code> task.</p><p>Here is how to use the plugin with Kotlin (replace the version numbers with the latest ones…):</p><pre><code class="hljs groovy">plugins {
  id <span class=hljs-string>'io.vertx.vertx-plugin'</span> version <span class=hljs-string>'x.y.z'</span>
  id <span class=hljs-string>'org.jetbrains.kotlin.jvm'</span> version <span class=hljs-string>'a.b.c'</span>
}

repositories {
  jcenter()
}

dependencies {
  compile <span class=hljs-string>'io.vertx:vertx-lang-kotlin'</span>
  compile <span class=hljs-string>'org.jetbrains.kotlin:kotlin-stdlib-jre8'</span>
}

vertx {
  mainVerticle = <span class=hljs-string>"sample.MainVerticle"</span>
}

tasks.withType(org.jetbrains.kotlin.gradle.tasks.KotlinCompile).all {
  kotlinOptions {
    jvmTarget = <span class=hljs-string>"1.8"</span>
  }
}</code></pre><h2 id=using-with-webpack-or-any-other-custom-task->Using with WebPack (or any other custom task)</h2><p>WebPack is popular to bundle web assets, and there is even <a href="https://guides.gradle.org/running-webpack-with-gradle/">a guide for its integration with Gradle</a>.</p><p>Mixing the Vert.x Gradle plugin with WebPack is very simple, especially in combination with the <code>com.moowork.node</code> plugin that integrates Node into Gradle.</p><p>Suppose we want to mix Vert.x code and JavaScript with Gradle and WebPack. We assume a <code>package.json</code> as:</p><pre><code class="hljs javascript">{
  <span class=hljs-string>"name"</span>: <span class=hljs-string>"webpack-sample"</span>,
  <span class=hljs-string>"version"</span>: <span class=hljs-string>"0.0.1"</span>,
  <span class=hljs-string>"description"</span>: <span class=hljs-string>"A sample with Vert.x, Gradle and Webpack"</span>,
  <span class=hljs-string>"main"</span>: <span class=hljs-string>"src/main/webapp/index.js"</span>,
  <span class=hljs-string>"scripts"</span>: {
    <span class=hljs-string>"test"</span>: <span class=hljs-string>"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>
  },
  <span class=hljs-string>"author"</span>: <span class=hljs-string>""</span>,
  <span class=hljs-string>"license"</span>: <span class=hljs-string>"ISC"</span>,
  <span class=hljs-string>"devDependencies"</span>: {
    <span class=hljs-string>"webpack"</span>: <span class=hljs-string>"^2.7.0"</span>
  },
  <span class=hljs-string>"dependencies"</span>: {
    <span class=hljs-string>"axios"</span>: <span class=hljs-string>"^0.16.2"</span>
  }
}</code></pre><p>and <code>webpack.config.js</code> as:</p><pre><code class="hljs javascript"><span class=hljs-built_in>module</span>.exports = {
  entry: <span class=hljs-string>'./src/main/webapp/index.js'</span>,
  output: {
    filename: <span class=hljs-string>'./build/resources/main/webroot/bundle.js'</span>
  }
}</code></pre><p>The <code>build.gradle</code> file is the following:</p><pre><code class="hljs groovy">plugins {
  id <span class=hljs-string>'io.vertx.vertx-plugin'</span> version <span class=hljs-string>'0.0.4'</span>
  id <span class=hljs-string>'com.moowork.node'</span> version <span class=hljs-string>'1.2.0'</span>
}

repositories {
  jcenter()
}

dependencies {
  compile <span class=hljs-string>"io.vertx:vertx-web"</span>
}

vertx {
  mainVerticle = <span class=hljs-string>"sample.MainVerticle"</span>
  watch = [<span class=hljs-string>"src/**/*"</span>, <span class=hljs-string>"build.gradle"</span>, <span class=hljs-string>"yarn.lock"</span>]
  onRedeploy = [<span class=hljs-string>"classes"</span>, <span class=hljs-string>"webpack"</span>]
}

task webpack(<span class=hljs-string>type:</span> Exec) {
  inputs.file(<span class=hljs-string>"$projectDir/yarn.lock"</span>)
  inputs.file(<span class=hljs-string>"$projectDir/webpack.config.js"</span>)
  inputs.dir(<span class=hljs-string>"$projectDir/src/main/webapp"</span>)
  outputs.dir(<span class=hljs-string>"$buildDir/resources/main/webroot"</span>)
  commandLine <span class=hljs-string>"$projectDir/node_modules/.bin/webpack"</span>
}</code></pre><p>This custom build exposes a <code>webpack</code> task that invokes WebPack, with proper file tracking so that Gradle knows when the task is up-to-date or not.</p><p>The Node plugin adds many tasks, and integrates fine with <code>npm</code> or <code>yarn</code>, so fetching all NPM dependencies is done by calling <code>./gradlew yarn</code>.</p><p>The <code>vertxRun</code> task now redeploys on modifications to files in <code>src/</code> (and sub-folders), <code>build.gradle</code> and <code>yarn.lock</code>, calling both the <code>classes</code> and <code>webpack</code> tasks:</p><iframe width=872 height=602 src="https://www.youtube.com/embed/OGy-1w8Z6Dc?rel=0" frameborder=0 allowfullscreen></iframe><h2 id=summary>Summary</h2><p>The Vert.x Gradle plugin provides lots of defaults to configure a Gradle project for Vert.x applications, producing <em>fat Jars</em> and offering a running task with automatic redeployment. The plugin also integrates well with other plugins and external tools for which a Gradle task is available.</p><p>The project is still in its early stages and we are looking forward to hearing from you!</p><h3 id=links>Links</h3><ul><li><a href=https://github.com/jponge/vertx-gradle-plugin>The project on GitHub</a></li><li><a href=https://plugins.gradle.org/plugin/io.vertx.vertx-plugin>The plugin on the Gradle plugins portal</a></li></ul></article></article></div><div class=row><div class=col-xs-12 id=disqus_thread></div></div><script>var disqus_config = function () {
  this.page.url = "https://vertx.io/preview/blog/an-eclipse-vert-x-gradle-plugin/";
  this.page.identifier = "/blog/an-eclipse-vert-x-gradle-plugin/";
  };
  (function() { // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = 'https://vertx.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
  })();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><footer><div class=container><div class=row><div class="col-xs-4 col-sm-4 col-md-2 col-lg-2"><h2>Eclipse Vert.x</h2><ul class=list-unstyled><li><a href="https://vertx.io/preview/">Home</a></li><li><a href="https://vertx.io/preview/download/">Download</a></li><li><a href="https://vertx.io/preview/docs/">Documentation</a></li><li><a href=https://github.com/vert-x3/wiki/wiki>Wiki</a></li><li><a href="https://vertx.io/preview/blog/">Blog</a></li><li><a href="https://vertx.io/preview/vertx2/" class=vertx-2-link>Vert.x 2</a></li></ul></div><div class="col-xs-4 col-sm-4 col-md-2 col-lg-2"><h2>Community</h2><ul class=list-unstyled><li><a href="https://vertx.io/preview/community/">Help &amp; Contributors</a></li><li><a href="https://vertx.io/preview/materials/">Learning materials</a></li><li><a href=https://groups.google.com/forum/?fromgroups#!forum/vertx>User Group</a></li><li><a href=https://groups.google.com/forum/?fromgroups#!forum/vertx-dev>Developer Group</a></li></ul></div><div class="col-xs-4 col-sm-4 col-md-2 col-lg-2"><h2>Eclipse</h2><ul class=list-unstyled><li><a href="http://www.eclipse.org/">Eclipse Foundation</a></li><li><a href=https://eclipse.org/legal/privacy.php>Privacy Policy</a></li><li><a href=https://eclipse.org/legal/termsofuse.php>Terms of Use</a></li><li><a href=https://eclipse.org/legal/copyright.php>Copyright Agent</a></li><li><a href=http://www.eclipse.org/legal>Legal Resources</a></li></ul></div><div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 copyright"><p>Eclipse Vert.x is open source and dual-licensed under the <a href=http://www.eclipse.org/legal/epl-v20.html>Eclipse Public License 2.0</a> and <a href=https://www.apache.org/licenses/LICENSE-2.0.html>Apache License 2.0</a>.</p><p>This website is licensed under the <a href="http://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA 3.0 License</a>.<br>Design by <a href=https://www.michel-kraemer.com>Michel Kr&auml;mer</a>.</p><div class=row><div class="col-sm-12 col-md-5 col-md-offset-1 col-lg-offset-2"><a href=http://eclipse.org><img class="logo eclipse-logo" src=https://vertx.io/preview/assets/eclipse_logo_grey_small.png width=204 height=48></a></div><div class="col-sm-12 col-md-5 col-md-offset-1 col-lg-offset-0"><a href=http://cloudbees.com><img class="logo cloudbees-logo" src=https://vertx.io/preview/assets/Button-Built-on-CB-1-grey.png width=180 height=48></a></div><div class="col-sm-12 col-md-5 col-md-offset-7 jprofiler"><a href=http://www.ej-technologies.com/products/jprofiler/overview.html style=text-decoration:none><img class="logo jprofiler-logo" src=https://vertx.io/preview/assets/jprofiler-logo.png width=48 height=48><span class=jprofiler-logo>&nbsp; JPROFILER</span></a></div></div></div></div></div></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js></script><script src=https://vertx.io/preview/javascripts/bootstrap.min.js></script><script src=https://vertx.io/preview/javascripts/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>